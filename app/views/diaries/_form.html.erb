<% content_for :addjs do %>
<script>
$(function(){
  var pattern = "<%= Diary.tag_counts.map{|t| t.name}.join(",") %>".split(",");
  $('#taglist').autocomplete(pattern, {
      minChars: 0,
      multiple: true,
      //mustMatch: true, //候補にあるものしか入力できないようにする
      //autoFill: true //入力中にオートフィルしてくれるみたいだけど、他の文字が入っちゃったりすることがあったので（日本語だからかな）、無効にしておく
  });
})
</script>
<% end %>

<%= simple_form_for(@diary) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.input :title, placeholder: '未入力でもOK', input_html: {class: 'span6'} %>
    <%= f.input :content, input_html: {class: 'span6', rows: 6} %>
    <%= f.input :tag_list, as: :string, label: "タグ <span class='desc'>カンマ区切りで複数指定可能</span>".html_safe, input_html: {id: 'taglist', class: 'span5', placeholder: '矢印キーを押下すれば既存のタグリストが表示されます'} %>

    <%= f.input :image, as: :file %>
    <%= f.input :user_id, as: :hidden %>
    <%= f.input :record_at, as: :hidden %>
  </div>

  <div class="form-actions">
    <%= f.button :submit %>
  </div>
<% end %>
